
<meta charset="utf-8">
<html lang="ko">
<head>
    <link rel="stylesheet" type="text/css" href="./../style.css" />
    <title>Remove an element from a list inside a loop</title>
</head>
<body id="tt-body-page" class="">
<div id="wrap" class="wrap-right">
    <div id="container">
        <main class="main ">
            <div class="area-main">
                <div class="area-view">
                    <div class="article-header">
                        <div class="inner-article-header">
                            <div class="box-meta">
                                <h2 class="title-article">Remove an element from a list inside a loop</h2>
                                <div class="box-info">
                                    <p class="category">Tech/Java</p>
                                    <p class="date">2016-07-07 16:41:00</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="article-view">
                        <div class="contents_style">
                            <p>A2와 A2MN이라는&nbsp;두 개의 DB에서 각각 List&lt;Map&lt;String, Object&gt;&gt;형식으로&nbsp;데이터를 받아 와,&nbsp;</p><p>A2에 존재하지 않는 데이터가 A2MN에 존재한다면 해당 데이터를 전부 삭제하는 기능을 만들어야 했다.</p><p><br /></p><p>그래서 생각해 낸 것이</p><p>1. A2와 A2MN으로 이중 루프를 돌리고, 키가 일치할 경우 A2MN리스트에서 해당 데이터를 삭제</p><p>2. 루프가 끝나면, A2MN의 사이즈를 체크</p><p>3. 사이즈가 0보다 클 경우, 다시 루프를 돌려서 루프 안에서 각 데이터를 하나씩 삭제하며 삭제 로그 기록</p><p>이었는데...</p><p><br /></p><p>이런 느낌으로 적어 봤더니</p><div class="colorscripter-code" style="color:#010101; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important; overflow:auto"><table class="colorscripter-code-table" style="margin:0; padding:0; border:none; background-color:#fafafa; border-radius:4px;" cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:6px; border-right:2px solid #e5e5e5"><div style="margin:0; padding:0; word-break:normal; text-align:right; color:#666; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div></div></td><td style="padding:6px 0"><div style="margin:0; padding:0; color:#010101; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">for</span>&nbsp;(Map<span style="color:#a71d5d">&lt;</span><span style="color:#066de2">String</span>,&nbsp;Object<span style="color:#a71d5d">&gt;</span>&nbsp;a2&nbsp;:&nbsp;a2mp)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#a71d5d">for</span>&nbsp;(Map<span style="color:#a71d5d">&lt;</span><span style="color:#066de2">String</span>,&nbsp;Object<span style="color:#a71d5d">&gt;</span>&nbsp;a2mn&nbsp;:&nbsp;a2mnmp)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>&nbsp;(a2.get(<span style="color:#63a35c">"join_no"</span>).<span style="color:#066de2">toString</span>().<span style="color:#066de2">equals</span>(a2mn.get(<span style="color:#63a35c">"join_no"</span>).<span style="color:#066de2">toString</span>())</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;a2.get(<span style="color:#63a35c">"maintain_no"</span>).<span style="color:#066de2">toString</span>().<span style="color:#066de2">equals</span>(a2mn.get(<span style="color:#63a35c">"maintain_no"</span>).<span style="color:#066de2">toString</span>()))&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a2mnmp.remove(a2mn);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;}</div><div style="padding:0 6px; white-space:pre; line-height:130%">}</div></div><div style="text-align:right; margin-top:-13px; margin-right:5px; font-size:9px; font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color: rgb(229, 229, 229);">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom; padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="color: white;"><span style="font-size: 9px; word-break: normal; border-radius: 10px; padding: 1px; background-color: rgb(229, 229, 229);">cs</span></a></td></tr></tbody></table></div><p>1에서 에러가 나는 것이었다.</p><p><br /></p><p>ConcurrentModificationException이 뜨길래 알아보니,</p><p>원본인 a2mn이 돌고 있는 와중에 원본 내용을 변경(삭제)시켰기 때문에 에러가 뜬 것이었다.</p><p>개인적으로 For-Each를 너무나 좋아하지만, 이번엔 포기할 수 밖에 없었다...</p><p><br /></p><div class="colorscripter-code" style="color:#010101; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important; overflow:auto"><p></p><div class="colorscripter-code" style="overflow: auto; position: relative !important;"></div><p></p><table class="colorscripter-code-table" style="margin:0; padding:0; border:none; background-color:#fafafa; border-radius:4px;" cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:6px; border-right:2px solid #e5e5e5"><div style="margin:0; padding:0; word-break:normal; text-align:right; color:#666; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div><div style="line-height:130%">24</div><div style="line-height:130%">25</div><div style="line-height:130%">26</div><div style="line-height:130%">27</div><div style="line-height:130%">28</div><div style="line-height:130%">29</div><div style="line-height:130%">30</div><div style="line-height:130%">31</div><div style="line-height:130%">32</div></div></td><td style="padding:6px 0"><div style="margin:0; padding:0; color:#010101; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//&nbsp;A2DB에서、적용&nbsp;데이터&nbsp;획득</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">List<span style="color:#a71d5d">&lt;</span>Map<span style="color:#a71d5d">&lt;</span><span style="color:#066de2">String</span>,&nbsp;Object<span style="color:#a71d5d">&gt;</span><span style="color:#a71d5d">&gt;</span>&nbsp;a2mp&nbsp;<span style="color:#a71d5d">=</span>&nbsp;<span style="color:#a71d5d">new</span>&nbsp;ArrayList<span style="color:#a71d5d">&lt;</span>Map<span style="color:#a71d5d">&lt;</span><span style="color:#066de2">String</span>,&nbsp;Object<span style="color:#a71d5d">&gt;</span><span style="color:#a71d5d">&gt;</span>&nbsp;();</div><div style="padding:0 6px; white-space:pre; line-height:130%">TekiyouForm&nbsp;a2param&nbsp;<span style="color:#a71d5d">=</span>&nbsp;<span style="color:#a71d5d">new</span>&nbsp;TekiyouForm();</div><div style="padding:0 6px; white-space:pre; line-height:130%">a2param.include_sousitu&nbsp;<span style="color:#a71d5d">=</span>&nbsp;<span style="color:#63a35c">"1"</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">a2mp&nbsp;<span style="color:#a71d5d">=</span>&nbsp;a2service.getSelectTekiyouInfo(a2param);</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//&nbsp;A2MNDB에서&nbsp;데이터&nbsp;전건&nbsp;획득</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">List<span style="color:#a71d5d">&lt;</span>Map<span style="color:#a71d5d">&lt;</span><span style="color:#066de2">String</span>,&nbsp;Object<span style="color:#a71d5d">&gt;</span><span style="color:#a71d5d">&gt;</span>&nbsp;a2mnmp&nbsp;<span style="color:#a71d5d">=</span>&nbsp;<span style="color:#a71d5d">new</span>&nbsp;ArrayList<span style="color:#a71d5d">&lt;</span>Map<span style="color:#a71d5d">&lt;</span><span style="color:#066de2">String</span>,&nbsp;Object<span style="color:#a71d5d">&gt;</span><span style="color:#a71d5d">&gt;</span>&nbsp;();</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#066de2">String</span>&nbsp;tbl&nbsp;<span style="color:#a71d5d">=</span>&nbsp;<span style="color:#63a35c">"individual_info"</span>;</div><div style="padding:0 6px; white-space:pre; line-height:130%">a2mnmp&nbsp;<span style="color:#a71d5d">=</span>&nbsp;service.dynamicSelectAll(tbl);</div><div style="padding:0 6px; white-space:pre; line-height:130%">Iterator<span style="color:#a71d5d">&lt;</span>Map<span style="color:#a71d5d">&lt;</span><span style="color:#066de2">String</span>,&nbsp;Object<span style="color:#a71d5d">&gt;</span><span style="color:#a71d5d">&gt;</span>&nbsp;a2mnIter&nbsp;<span style="color:#a71d5d">=</span>&nbsp;a2mnmp.iterator();</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//&nbsp;A2DB와&nbsp;A2MNDB을&nbsp;비교,「join_no」와「maintain_no」가&nbsp;일치하는&nbsp;데이터를&nbsp;리스트에서&nbsp;없앰</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">while</span>&nbsp;(a2mnIter.hasNext())&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;Map<span style="color:#a71d5d">&lt;</span><span style="color:#066de2">String</span>,&nbsp;Object<span style="color:#a71d5d">&gt;</span>&nbsp;a2mn&nbsp;<span style="color:#a71d5d">=</span>&nbsp;a2mnIter.next();</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#a71d5d">for</span>&nbsp;(Map<span style="color:#a71d5d">&lt;</span><span style="color:#066de2">String</span>,&nbsp;Object<span style="color:#a71d5d">&gt;</span>&nbsp;a2&nbsp;:&nbsp;a2mp)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a71d5d">if</span>&nbsp;(a2.get(<span style="color:#63a35c">"join_no"</span>).<span style="color:#066de2">toString</span>().<span style="color:#066de2">equals</span>(a2mn.get(<span style="color:#63a35c">"join_no"</span>).<span style="color:#066de2">toString</span>())</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&amp;&amp;&nbsp;a2.get(<span style="color:#63a35c">"maintain_no"</span>).<span style="color:#066de2">toString</span>().<span style="color:#066de2">equals</span>(a2mn.get(<span style="color:#63a35c">"maintain_no"</span>).<span style="color:#066de2">toString</span>()))&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;a2mnIter.remove();</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;}<span style="color:#999999">//&nbsp;END&nbsp;if</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;}<span style="color:#999999">//&nbsp;END&nbsp;for</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">}<span style="color:#999999">//&nbsp;END&nbsp;while</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">//&nbsp;A2MN리스트가&nbsp;남아&nbsp;있을&nbsp;경우</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#a71d5d">if</span>&nbsp;(a2mnmp.size()&nbsp;<span style="color:#a71d5d">&gt;</span>&nbsp;<span style="color:#0099cc">0</span>)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;<span style="color:#a71d5d">for</span>&nbsp;(Map<span style="color:#a71d5d">&lt;</span><span style="color:#066de2">String</span>,&nbsp;Object<span style="color:#a71d5d">&gt;</span>&nbsp;a2mn&nbsp;:&nbsp;a2mnmp)&nbsp;{</div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#999999">/**</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*&nbsp;데이터&nbsp;삭제&nbsp;작업&nbsp;및&nbsp;삭제&nbsp;로그&nbsp;입력</span></div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;&nbsp;}<span style="color:#999999">//&nbsp;END&nbsp;for</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">}<span style="color:#999999">//&nbsp;END&nbsp;if</span></div></div><div style="text-align:right; margin-top:-13px; margin-right:5px; font-size:9px; font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color:#e5e5e5; text-decoration:none">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom; padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="text-decoration:none; color:white"><span style="font-size:9px; word-break:normal; background-color:#e5e5e5; color:white; border-radius:10px; padding:1px">cs</span></a></td></tr></tbody></table></div><p><br /></p><p>Iterator의 next()를 remove() 전에 호출해 두고 삭제를 돌려서</p><p>ConcurrentModificationException를 피할 수 있었다.</p>
                        </div>
                        <br/>
                        <div class="tags">
                            
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
</body>
</html>
