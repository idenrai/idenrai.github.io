
<meta charset="utf-8">
<html lang="ko">
<head>
    <link rel="stylesheet" type="text/css" href="./../style.css" />
    <title>Extract json value in bash</title>
</head>
<body id="tt-body-page" class="">
<div id="wrap" class="wrap-right">
    <div id="container">
        <main class="main ">
            <div class="area-main">
                <div class="area-view">
                    <div class="article-header">
                        <div class="inner-article-header">
                            <div class="box-meta">
                                <h2 class="title-article">Extract json value in bash</h2>
                                <div class="box-info">
                                    <p class="category">Tech/Shell</p>
                                    <p class="date">2016-07-08 16:36:04</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                    <div class="article-view">
                        <div class="contents_style">
                            <p>Java로 작성해 둔 API를 리눅스 서버에서 Bash로 돌려야 했다.</p><p>보안상 Token을 따서, 그걸 집어넣어 API를 돌리는 방식인데...</p><p>일단 어찌어찌 CURL로 Token은 따 왔는데, 받아오고 보니 JSON으로 리턴되어 오더라.</p><p>남은 건 KEY를 집어넣어서 Token값을 따오는 것 뿐인데...</p><p>보이는 거라곤 다 뭔가를 깃허브에서 갖고와서 그걸 써서&nbsp;따온다...라는 것이라</p><p>한참동안 다른 방법을 찾아다녔다.</p><p><br /></p><p>결국 찾아낸 것이 <a href="https://www.experts-exchange.com/questions/27568762/How-to-parse-json-response-in-bash-script.html" target="_blank" class="tx-link"><b>이 방식</b></a>.</p><p><br /></p><p>token =&nbsp;$response | sed -e 's/^.*"token_key"[ ]*:[ ]*"//' -e 's/".*//'`</p><p><br /></p><p>코드에 적용하면 이런 느낌이다.</p><p><br /></p><div class="colorscripter-code" style="color:#010101; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; position:relative !important; overflow:auto"><table class="colorscripter-code-table" style="margin:0; padding:0; border:none; background-color:#fafafa; border-radius:4px;" cellspacing="0" cellpadding="0"><tbody><tr><td style="padding:6px; border-right:2px solid #e5e5e5"><div style="margin:0; padding:0; word-break:normal; text-align:right; color:#666; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="line-height:130%">1</div><div style="line-height:130%">2</div><div style="line-height:130%">3</div><div style="line-height:130%">4</div><div style="line-height:130%">5</div><div style="line-height:130%">6</div><div style="line-height:130%">7</div><div style="line-height:130%">8</div><div style="line-height:130%">9</div><div style="line-height:130%">10</div><div style="line-height:130%">11</div><div style="line-height:130%">12</div><div style="line-height:130%">13</div><div style="line-height:130%">14</div><div style="line-height:130%">15</div><div style="line-height:130%">16</div><div style="line-height:130%">17</div><div style="line-height:130%">18</div><div style="line-height:130%">19</div><div style="line-height:130%">20</div><div style="line-height:130%">21</div><div style="line-height:130%">22</div><div style="line-height:130%">23</div></div></td><td style="padding:6px 0"><div style="margin:0; padding:0; color:#010101; font-family:Consolas, 'Liberation Mono', Menlo, Courier, monospace !important; line-height:130%"><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#!/bin/sh</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">APP_NAME<span style="color:#a71d5d">=</span>bulk_delete</div><div style="padding:0 6px; white-space:pre; line-height:130%">RETURN<span style="color:#a71d5d">=</span><span style="color:#0099cc">0</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#URL</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">URL<span style="color:#a71d5d">=</span><span style="color:#63a35c">""</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#Token</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">USER<span style="color:#a71d5d">=</span><span style="color:#63a35c">""</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">PW<span style="color:#a71d5d">=</span><span style="color:#63a35c">""</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">AC<span style="color:#a71d5d">=</span><span style="color:#63a35c">""</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">TOKEN_URL<span style="color:#a71d5d">=</span><span style="color:#63a35c">""</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#Get&nbsp;JSON</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">RESPONSE<span style="color:#a71d5d">=</span>`$TOKEN_URL`</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#066de2">echo</span>&nbsp;<span style="color:#63a35c">"$RESPONSE"</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#999999">#KEY=access_token</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">TOKEN<span style="color:#a71d5d">=</span>`<span style="color:#066de2">echo</span>&nbsp;$RESPONSE&nbsp;<span style="color:#a71d5d">|</span>&nbsp;sed&nbsp;<span style="color:#a71d5d">-</span>e&nbsp;<span style="color:#63a35c">'s/^.*"access_token"[&nbsp;]*:[&nbsp;]*"//'</span>&nbsp;<span style="color:#a71d5d">-</span>e&nbsp;<span style="color:#63a35c">'s/".*//'</span>`</div><div style="padding:0 6px; white-space:pre; line-height:130%"><span style="color:#066de2">echo</span>&nbsp;<span style="color:#63a35c">"TOKEN&nbsp;:&nbsp;$TOKEN"</span></div><div style="padding:0 6px; white-space:pre; line-height:130%">&nbsp;</div><div style="padding:0 6px; white-space:pre; line-height:130%">exit&nbsp;$RETURN</div></div><div style="text-align:right; margin-top:-13px; margin-right:5px; font-size:9px; font-style:italic"><a href="http://colorscripter.com/info#e" target="_blank" style="color: rgb(229, 229, 229);">Colored by Color Scripter</a></div></td><td style="vertical-align:bottom; padding:0 2px 4px 0"><a href="http://colorscripter.com/info#e" target="_blank" style="color: white;"><span style="font-size: 9px; word-break: normal; border-radius: 10px; padding: 1px; background-color: rgb(229, 229, 229);">cs</span></a></td></tr></tbody></table></div><p><br /></p>
                        </div>
                        <br/>
                        <div class="tags">
                            
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>
</body>
</html>
